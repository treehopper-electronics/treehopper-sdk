/// This file was auto-generated by RegisterGenerator. Any changes to it will be overwritten!
using System;
using System.Diagnostics;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Treehopper;
using Treehopper.Libraries.Utilities;

namespace Treehopper.Libraries.{{Namespace}}
{
    public partial class {{Name}}
    {
        {{#RegisterList}}
        {{#Values.Values}}
        {{#Enum}}
        {{#IsPublic}}public{{/IsPublic}}{{^IsPublic}}internal{{/IsPublic}} enum {{PluralizedName}}
        {
        {{#ValuesList}}
            {{Key}} = {{#Value}}{{Value}}{{^Last}},{{/Last}}{{/Value}}
        {{/ValuesList}}
        }

        {{/Enum}}
        {{/Values.Values}}
        {{/RegisterList}}
        protected class {{Name}}Registers : RegisterManager
        {
            internal {{Name}}Registers(SMBusDevice dev = null) : base(dev, {{MultiRegisterAccess}})
            {
                {{#RegisterList}}
                {{Name}} = new {{CapitalizedName}}Register(this);
                _registers.Add({{Name}});
                {{/RegisterList}}
            }

        {{#RegisterList}}
            internal {{CapitalizedName}}Register {{Name}};
        {{/RegisterList}}

        {{#RegisterList}}
            internal class {{CapitalizedName}}Register : Register
            {
                internal {{CapitalizedName}}Register(RegisterManager regManager) : base(regManager, {{Address}}, {{NumBytes}}, {{IsBigEndian}}) { }

            {{#Values.Values}}
                public int {{Name}} { get; set; }
            {{/Values.Values}}
{{#Values.Values}}
        {{#Enum}}
                public {{PluralizedName}} get{{CapitalizedName}}() { return ({{PluralizedName}}){{Name}}; }
                public void set{{CapitalizedName}}({{PluralizedName}} enumVal) { {{Name}} = (int)enumVal; }
        {{/Enum}}
        {{/Values.Values}}

                public async Task<{{CapitalizedName}}Register> read()
                {
                    await manager.read(this).ConfigureAwait(false);
                    return this;
                }
                internal override long getValue() { return {{#Values.Values}}(({{Name}} & {{Bitmask}}) << {{Offset}}){{^Last}} | {{/Last}}{{/Values.Values}}; }
                internal override void setValue(long _value)
                {
                    {{#Values.Values}}
                    {{#IsSigned}}
                    {{Name}} = (int)(((_value >> {{Offset}}) & {{Bitmask}}) << (32 - {{Width}})) >> (32 - {{Width}});
                    {{/IsSigned}}
                    {{^IsSigned}}
                    {{Name}} = (int)((_value >> {{Offset}}) & {{Bitmask}});
                    {{/IsSigned}}
                    {{/Values.Values}}
                }

                public override string ToString()
                {
                    string retVal = "";
                    {{#Values.Values}}
                    retVal += $"{{CapitalizedName}}: { {{Name}} } (offset: {{Offset}}, width: {{Width}})\r\n";
                    {{/Values.Values}}
                    return retVal;
                }
            }
        {{/RegisterList}}
        }
    }
}